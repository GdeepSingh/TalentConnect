<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Skills • TalentConnect</title>
<link rel="stylesheet" href="../css/style.css">
</head>

<body>

<header class="site-header">
  <div class="site-header__inner">
    <div class="brand">
      <div class="brand__logo"></div>
      <div class="brand__name">TalentConnect</div>
    </div>
    <div class="muted">Step <strong>4</strong> of 4</div>
  </div>
</header>

<main class="container">
  <div class="stepper">
    <div class="stepper__dot stepper__dot--done"></div>
    <div class="stepper__dot stepper__dot--done"></div>
    <div class="stepper__dot stepper__dot--done"></div>
    <div class="stepper__dot stepper__dot--active"></div>
  </div>

  <section class="card">
    <h1 class="card__title">Skills & Other Info</h1>
    <p class="card__note">Add a few skills and languages.</p>

    <!-- Remove action/method because we will use JS to submit -->
    <form id="skillsForm">

      <label>Skills</label>
      <textarea name="skills" rows="3" placeholder="Java, PHP, SQL"></textarea>

      <label>Languages</label>
      <textarea name="languages" rows="2" placeholder="English, Punjabi"></textarea>

      <label>Phone (optional)</label>
      <input type="text" name="phone" placeholder="+1 604 555 0000">

      <div class="actions">
        <input type="button" class="btn btn--primary" id="finishBtn" value="Finish →">
      </div>

    </form>

  </section>
</main>

<footer class="site-footer">© 2025 TalentConnect</footer>

<script>
// ------------------ SKILLS SUBMISSION ------------------

document.getElementById("finishBtn").addEventListener("click", async () => {

    const form = new FormData();
    form.append("type", "skills_form");
    form.append("skills", document.querySelector("[name='skills']").value);
    form.append("languages", document.querySelector("[name='languages']").value);
    form.append("phone", document.querySelector("[name='phone']").value);

    try {
        const res = await fetch("../../Backend/userinfo.php", {
            method: "POST",
            body: form
        });

        const data = await res.json();

        if (data.success) {
            // REDIRECT TO USER PROFILE
            window.location.href = "../User/user_profile.html";
        } else {
            alert("Error: " + data.error);
        }

    } catch (err) {
        alert("Server error. Try again.");
        console.error(err);
    }

});
</script>

</body>
</html>
