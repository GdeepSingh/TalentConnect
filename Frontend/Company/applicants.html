<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Applicants · TalentConnect</title>
  <link rel="stylesheet" href="../css/style.css"/>

  <style>
.card.wide{width:900px;}
.cards-wrap{
  overflow-y:auto;
  display:flex;
  flex-direction:column;
  gap:14px;
  max-height:520px;
  scrollbar-width:none;
}
.muted{color:#6b7280}
.pill{display:inline-block;padding:.2rem .6rem;border-radius:999px;font-size:.8rem}
.pill--ok{background:#dcfce7;color:#166534}
.pill--bad{background:#fee2e2;color:#991b1b}
.divider{height:1px;background:var(--border);opacity:.8;margin:.5rem 0 1rem}
.summary{display:flex;gap:.6rem;flex-wrap:wrap}
.summary span{background:#f3f4f6;border:1px solid var(--border);border-radius:999px;padding:.25rem .6rem;font-size:.9rem}
  </style>
</head>

<body>

<header class="site-header">
  <div class="site-header__inner">
    <a href="company_dashboard.html" class="brand">
      <span class="brand__logo"></span>
      <span class="brand__name">TalentConnect</span>
    </a>
    <nav style="display:flex;gap:12px;">
      <a class="btn btn--ghost" href="company_dashboard.html">Dashboard</a>
      <a class="btn btn--ghost" href="post_job.html">Post a Job</a>
      <a class="btn btn--ghost" href="manage_jobs.html">Manage Jobs</a>
      <a class="btn btn--ghost" href="applicants.html">Applicants</a>
      <a class="btn btn--ghost" href="company_profile.html">Company Profile</a>
      <a class="btn" href="company_login.html">Sign out</a>
    </nav>
  </div>
</header>

<main class="container">

  <div class="card wide">
    <p class="card__title">Applicants</p>
    <p class="card__note">Review candidates by role. Status updates auto-save.</p>

    <div class="summary" id="summaryBox"></div>
    <div class="divider"></div>

    <div class="cards-wrap" id="cards"></div>
  </div>

</main>

<footer class="site-footer">
  <p>© 2025 TalentConnect · Employers Portal</p>
</footer>


<script>
function getJobs(){ return JSON.parse(localStorage.getItem("tc_jobs") || "[]"); }
function getApplicants(){ return JSON.parse(localStorage.getItem("tc_applicants") || "{}"); }

const apps = getApplicants();
const users = JSON.parse(localStorage.getItem("tc_users") || "[]");

function getUserProfile(email){
  return {
    base: users.find(u=>u.email===email) ?? {},
    exp: JSON.parse(localStorage.getItem("tc_experience") || "[]"),
    edu: JSON.parse(localStorage.getItem("tc_education") || "[]"),
    skill: JSON.parse(localStorage.getItem("tc_skills") || "{}"),
  };
}

let html = "";

Object.entries(apps).forEach(([jobId, arr])=>{
  const job = getJobs().find(j=>j.id===jobId);
  html += `<h2>${job?.title ?? "Unknown Job"}</h2>`;

  arr.forEach(a=>{
    const profile = getUserProfile(a.userEmail);

    html += `
      <div class="card">
        <h3>${profile.base.name}</h3>
        <p><b>Applied:</b> ${new Date(a.appliedAt).toLocaleDateString()}</p>
        <p><b>Skills:</b> ${profile.skill.skills ?? "—"}</p>
        <p><b>Education:</b> ${profile.edu.length ? profile.edu[0].degree+" ("+profile.edu[0].school+")" : "—"}</p>
        <p><b>Experience:</b> ${profile.exp.length ? profile.exp[0].title+" @ "+profile.exp[0].company : "—"}</p>
        <p><b>City:</b> ${profile.skill.city ?? "—"}</p>
      </div>
    `;
  });
});

document.getElementById("applicantsBox").innerHTML = html;

</script>

</body>
</html>
